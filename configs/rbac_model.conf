[request_definition]
r = org, proj, obj, act

[policy_definition]
p = sub, obj, act

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
# 按角色授权访问权限，动作为 all 的允许所有动作权限（适用于各类管理员）
# g(r.sub, p.sub) && r.obj == p.obj &&
#        r.act == p.act || p.act == "all")
# 平台管理员角色允许访问所有内容
# r.sub == "root"
# 允许资源匿名访问
# p.sub == "anymouse"

m = (r.org == p.sub && r.obj == p.obj && (r.act == p.act)) || ((r.proj == p.sub) && r.obj == p.obj && (r.act == p.act)) || (p.sub == "anonymous" && r.obj == p.obj && (r.act == p.act))
